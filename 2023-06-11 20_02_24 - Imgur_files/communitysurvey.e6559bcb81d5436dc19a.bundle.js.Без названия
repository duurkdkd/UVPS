(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{"3zr+":function(e,t,n){},DB0j:function(e,t,n){"use strict";n.r(t),n.d(t,"Survey",(function(){return O}));var s=n("RIqP"),a=n.n(s),r=n("lwsE"),i=n.n(r),o=n("W8MJ"),u=n.n(o),c=n("PJYZ"),l=n.n(c),d=n("7W2i"),p=n.n(d),m=n("a1gu"),y=n.n(m),v=n("Nsbk"),f=n.n(v),b=n("lSNA"),g=n.n(b),h=n("q1tI"),w=n.n(h),S=(n("17x9"),n("/MKj")),I=n("G5ih"),N=n("TSYQ"),q=n.n(N),A=n("IlJ3");n("3zr+"),n("nzy5");function E(e){var t=e.className,n=e.style,s=e.children,a=q()(g()({Animate:!0},t,t));return w.a.createElement("div",{className:a,style:n},s)}E.defaultProps={className:"",style:{}},E.__docgenInfo={description:"",methods:[],displayName:"Animate",props:{className:{defaultValue:{value:"''",computed:!1},type:{name:"string"},required:!1,description:""},style:{defaultValue:{value:"{}",computed:!1},type:{name:"object"},required:!1,description:""},children:{type:{name:"instanceOf",value:"Object"},required:!1,description:""}}};var C=n("7oyi"),k=n("GB65"),M=n("BWa0"),j=n("pNV7");n("dUUo");function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(s,arguments,a)}else n=s.apply(this,arguments);return y()(this,n)}}var O=function(e){p()(n,e);var t=D(n);function n(e){var s;return i()(this,n),s=t.call(this,e),g()(l()(s),"onAnswer",(function(e){var t=s.props,n=t.addAnswer,a=t.personId;t.waitingForResponse||n(a,e)})),g()(l()(s),"onMessage",(function(e){e.preventDefault();var t=s.props,n=t.addMessage,a=t.personId,r=t.surveyId,i=t.waitingForResponse,o=s.state.message;o&&!i&&(n(a,r,o),s.setState({submitted:!0}),setTimeout(s.onClose,6e3))})),g()(l()(s),"onChangeMessage",(function(e){s.setState({message:e.target.value})})),g()(l()(s),"onClose",(function(){var e=s.props,t=e.username,n=e.personId,a=e.surveyId,r=e.completedAnalytics,i=e.abandonedAnalytics;n?r(t,n,a):i(t),s.setState({visible:!1})})),g()(l()(s),"showSurveyModal",(function(){var e=s.props,t=e.counter,n=e.isShowed,a=e.updateIsShowed,r=e.updateCounter;if(!n){if(t>=10){var i=Math.random();if(Object(k.O)().debug&&(i=0),i<5e-4){(0,s.props.createUser)(),s.setState({visible:!0});var o=new Date;o.setDate(o.getDate()+30),a(!0,o.toString())}}var u=new Date;u.setDate(u.getDate()+1),u.setHours(0,0,0,0),r(t+1,u.toString())}})),s.state={message:"",visible:!1,submitted:!1},s}return u()(n,[{key:"componentDidMount",value:function(){this.showSurveyModal()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.personId,s=t.currentPostId,a=t.username,r=t.displayedAnalytics,i=this.state.visible;e.personId!==n&&r(n,a),e.currentPostId&&e.currentPostId!==s&&(i?this.onClose():this.showSurveyModal())}},{key:"render",value:function(){var e,t=this,n=this.props.surveyId,s=this.state,r=s.message,i=s.visible,o=s.submitted;if(!i)return null;var u=a()(Array(5)).map((function(e,n){return w.a.createElement(C.a,{className:"survey-answer survey-answer--".concat(n+1),onClick:function(){return t.onAnswer(n+1)},label:Object(I.b)("surveyAnswer".concat(n+1)),key:n})})),c=q()((e={Survey:!0},g()(e,"slide",!0),g()(e,"inLeft","inLeft"),e)),l=q()({"btn btn-main":!0,"survey-done":!0,disabled:0===r.length}),d=1;return n&&(d=o?3:2),w.a.createElement(E,{className:c},w.a.createElement("div",{className:"Survey-content"},function(){switch(d){case 1:return w.a.createElement("div",{className:"step step--1"},w.a.createElement(C.b,{className:"step-close",image:w.a.createElement(M.fb,{name:M.h,width:"32",height:"32"}),onClick:t.onClose}),w.a.createElement("p",{className:"step-label"},Object(I.b)("surveyLabelStep1")),w.a.createElement("div",{className:"answer-options"},u));case 2:return w.a.createElement("div",{className:"step step--2"},w.a.createElement("p",{className:"step-label"},Object(I.b)("surveyLabelStep2")),w.a.createElement("div",{className:"answer-options"},w.a.createElement("textarea",{onChange:t.onChangeMessage,value:r,placeholder:Object(I.b)("surveyTextareaPlaceholder"),maxLength:240,required:!0}),w.a.createElement(C.a,{type:"button",className:l,label:Object(I.b)("surveySubmit"),onClick:t.onMessage})),w.a.createElement("p",{className:"step-dismiss",onClick:function(){return t.onClose()}},Object(I.b)("surveyDismissStep2")));case 3:return w.a.createElement("div",{className:"step step--3"},w.a.createElement("p",{className:"step-label"},Object(I.b)("surveyLabelStep3")),w.a.createElement(j.V,{name:j.U}),w.a.createElement("p",{className:"step-dismiss",onClick:function(){return t.setState({visible:!1})}},Object(I.b)("surveyDismissStep3")))}}()))}}]),n}(h.Component);O.__docgenInfo={description:"",methods:[{name:"onAnswer",docblock:null,modifiers:[],params:[{name:"answer",type:null}],returns:null},{name:"onMessage",docblock:null,modifiers:[],params:[{name:"e",type:null}],returns:null},{name:"onChangeMessage",docblock:null,modifiers:[],params:[{name:"e",type:null}],returns:null},{name:"onClose",docblock:null,modifiers:[],params:[],returns:null},{name:"showSurveyModal",docblock:null,modifiers:[],params:[],returns:null}],displayName:"Survey",props:{createUser:{type:{name:"func"},required:!0,description:""},addAnswer:{type:{name:"func"},required:!0,description:""},addMessage:{type:{name:"func"},required:!0,description:""},updateCounter:{type:{name:"func"},required:!0,description:""},updateIsShowed:{type:{name:"func"},required:!0,description:""},displayedAnalytics:{type:{name:"func"},required:!0,description:""},completedAnalytics:{type:{name:"func"},required:!0,description:""},abandonedAnalytics:{type:{name:"func"},required:!0,description:""},personId:{type:{name:"union",value:[{name:"number"},{name:"string"}]},required:!1,description:""},surveyId:{type:{name:"union",value:[{name:"number"},{name:"string"}]},required:!1,description:""},username:{type:{name:"string"},required:!1,description:""},waitingForResponse:{type:{name:"bool"},required:!1,description:""},currentPostId:{type:{name:"string"},required:!1,description:""},isShowed:{type:{name:"bool"},required:!1,description:""},counter:{type:{name:"number"},required:!1,description:""}}};t.default=Object(S.b)((function(e){var t=e.survey,n=e.user,s=e.ui,a=e.postsData;return{isShowed:t.get("isShowed"),counter:t.get("counter"),personId:t.get("personId"),surveyId:t.get("surveyId"),username:n.get("username"),waitingForResponse:s.spinner.get("survey",{}).loading,currentPostId:a.getIn(["currentPost","id"])}}),{createUser:A.j,addAnswer:A.g,addMessage:A.h,updateCounter:A.l,updateIsShowed:A.m,completedAnalytics:A.i,abandonedAnalytics:A.f,displayedAnalytics:A.k})(O)},dUUo:function(e,t,n){},nzy5:function(e,t,n){}}]);